# MPM for snow ball
このプロジェクトはMaterial Point Method（物質点法）をC++のOpenGLを用いて，実装した簡易的な2次元シミュレーションです．

## MPM
物質点法（MPM）は，連続体の力学問題を数値的に解くための計算手法です．この方法は、粒子法と格子法の両方の利点を組み合わせたもので，粒子による物理的な性質（例：質量、運動量）の表現と、格子（グリッド）を用いた計算安定性を融合しています．主に大規模な変形や破壊問題，流体-固体相互作用問題などに適用されます．
## 粒子法
粒子法（例：SPH法）では，物理量は粒子に直接割り当てられ，粒子間の相互作用に基づいて計算されます．粒子法は大きな変形や流れに対して柔軟ですが，数値的な不安定性や不正確さを引き起こす可能性があります．MPMでは，粒子は物理的な情報を運び，物質の変形や動きを追跡するのに使用されますが，計算自体は格子上で行われるため，粒子法の欠点を克服しています．

## 格子法
格子法（例：有限要素法）では，計算ドメインは固定された格子（グリッド）に分割され，物理量は格子点で計算されます．格子法は数値的に安定しているものの，大きな変形や複雑なフリーフォームの動きを処理する際には限界があります．MPMでは，格子は計算の安定性を提供するために使用され，粒子から格子へ，そして格子から粒子への情報の移動が行われることで，格子法の限界を克服します．

## PIC/FLIP
PIC（Particle-In-Cell）とFLIP（Fluid Implicit Particle）は，流体のシミュレーションにおいて用いられる手法で，粒子と格子の両方を使用します．PICは、粒子から格子への情報の移動に重点を置いており，FLIPは粒子の情報を保持しつつ格子を使用して力学的な計算を行います．MPMは、これらの手法の考え方を一般化し，より広範な物理現象（固体，流体，その相互作用）のシミュレーションに適用しています．


### Step1:
領域内に背景格子を張り，速度や質量等の物理量は粒子に持たせる．

### Step2:
粒子が持つ物理量を各格子点に補間する．

### Step3:
格子点で更新のための数値計算をする．

### Step4:
計算結果を粒子に補間し，変形を粒子に適応させる．


## プロジェクト説明
*mpm.py*と*stencil.py*はそれぞれが独立したものとなっており，異なるシミュレーションになっています．*stencil.py*では，MPMの無駄な計算を省くための改良を行い，実行速度が高性能化されています．しかし，基本的な実行結果は同じです．

## シミュレーション内容・実行例
以下にプロジェクトの実行例を示します．
本プロジェクトでは，MPMの基本的な2次元シミュレーションを行うために，物体の自由落下という状況を想定しています．また，そのほかにも力のかかる向きを任意の方向に変化させることも可能です．

実行画面にある通り，物体を点の集合を表し，自由落下をシミュレーションしています．

## インストールと使用法
本プロジェクトでは，Pythonベースのプログラミング言語とフレームワークであり、高性能な数値計算と物理シミュレーションを行うために設計された*Taichi*を使用します．*Taichi*は、GPUを活用して高速なシミュレーションや視覚化を行うことができることが特徴です．
https://github.com/taichi-dev/taichi

```
pip install taichi
```

## License
This project is released under the MIT License.
